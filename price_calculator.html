<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="data:image/vnd.microsoft.icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAACAAAAAQAAAAIAAAACAAAAAQAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAABAAAAALAAAADwAAAAwAAAAOAAAADgAAAAwAAAAQAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABEAAAAVwAAAFYAAABWAAAAVgAAAFYAAABWAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAuAAAALoAAADQAAAAvQAAAMcAAADHAAAAvQAAAMoAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAALkAAACOAAAAvAAAAJcAAACsAAAArAAAAJcAAADAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAAC5AAAAigAAALkAAACTAAAAqAAAAKgAAACSAAAAvgAAADQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAvAAAAKEAAADHAAAApwAAALkAAAC5AAAApwAAAMcAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAALoAAACQAAAAvQAAAJgAAACtAAAArQAAAJgAAADBAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAAC4AAAAhwAAALgAAACQAAAApgAAAKcAAACQAAAAvQAAADQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAxgAAANoAAADoAAAA2wAAAN4AAADTAAAAzAAAANkAAAAzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAM0AAAD/AAAA/wAAAP8AAADqAAAAsgAAALQAAADRAAAAMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAADKAAAA2gAAAM0AAADNAAAAzQAAAMsAAADPAAAA5QAAADIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAvgAAAEEAAAAMAAAADwAAAA8AAAAOAAAAHwAAAMAAAAA1AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAMcAAAC1AAAAngAAAJ8AAACfAAAAngAAAKYAAADcAAAAMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAACSAAAAugAAALkAAAC5AAAAuQAAALkAAAC5AAAAqgAAACMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAABAAAAAAAAAAAAAAAA4AcAAOAHAADgBwAA4AcAAOAHAADgBwAA4AcAAOAHAADgBwAA4AcAAOAHAADgBwAA4AcAAOAHAADgBwAA4AcAAA==" />
    <title>Price Calculator</title>
    <link rel="stylesheet" href="css/app.css" />
</head>
<body onload="onLoad()">
    <noscript>
        <div id="noscript">
            <h1>This page uses JavaScript</h1>
            <p>Please, activate javascript in your browser or use other browser</p>
        </div>
    </noscript>

    <form class="row" onchange="onChange()" autocomplete="off">
        <div class="large-4 column">
            <div class="row collapse">
                <div class="medium-2 column">
                    <div class="row collapse">
                        <div class="small-9 column">
                            <label class="prefix">VAT</label>
                        </div>
                        <div class="small-3 column">
                            <input type="checkbox" id="vat_included" checked>
                        </div>
                    </div>
                </div>
                <div class="medium-1 column">
                    &nbsp;
                </div>
                <div class="medium-6 column">
                    <div class="row collapse">
                        <div class="small-6 column">
                            <label class="prefix">Server:</label>
                        </div>
                        <div class="small-6 column">
                            <select id="select_servers">
                                <option>SB</option>
                                <option>EX40</option>
                                <option>EX40SSD</option>
                                <option>EX60</option>
                                <option>PX60</option>
                                <option>PX60SSD</option>
                                <option>PX70</option>
                                <option>PX70SSD</option>
                                <option>PX90</option>
                                <option>PX90SSD</option>
                                <option>PX120</option>
                                <option>PX120SSD</option>
                                <option>SX60</option>
                                <option>SX130</option>
                                <option>SX290</option>
                                <option>DX150</option>
                                <option>DX290</option>
                                <option>RACK20</option>
                                <option>VQ7</option>
                                <option>VQ12</option>
                                <option>VQ19</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="medium-1 column">
                    &nbsp;
                </div>
                <div class="medium-2 column">
                    <div class="row collapse">
                          <div class="small-6 column">
                              <label class="prefix">SB:</label>
                          </div>
                          <div class="small-6 column">
                              <input type="text" placeholder="0" id="sb_number">
                        </div>
                    </div>
                </div>

                <div class="row collapse">
                    <div class="medium-5 column">
                        <div class="row collapse">
                            <div class="small-6 column">
                                <label class="prefix">Date:</label>
                            </div>
                            <div class="small-6 column">
                                <input type="text" id="ordering_date" value="today">
                            </div>
                        </div>
                    </div>
                    <div class="medium-1 column">
                    </div>
                    <div class="medium-6 column">
                        <div class="row collapse">
                            <div class="small-6 column">
                                <label class="prefix">Language:</label>
                            </div>
                            <div class="small-6 column">
                                <select id="select_languages" onChange="setAndUpdateUILanguage()">
                                    <option>English</option>
                                    <option>Deutsch</option>
                                    <option>Русский</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <fieldset>
                    <legend>Addons</legend>
                    <input type="checkbox" id="win_std"><label for="win_std">win_std</label><br/>
                    <input type="checkbox" id="win_dc"><label for="win_dc">win_dc</label><br/>
                    <div class="row collapse">
                        <div class="small-1 columns">
                            <input type="text" placeholder="0" id="rdp_license" />
                        </div>
                        <div class="small-11 columns">
                            <label class="postfix" for="rdp_license">rdp_license</label>
                        </div>
                    </div>
                    <div class="row collapse">
                        <div class="small-4 columns">
                            <select id="select_plesk" onchange="update()">
                                <option>no</option>
                                <option>web_admin</option>
                                <option>web_app</option>
                                <option>web_pro</option>
                                <option>web_host</option>
                            </select>
                        </div>
                        <div class="small-8 columns">
                            <label class="postfix">Plesk Panel 12</label>
                        </div>
                    </div>
                    <input type="checkbox" id="plesk_power_pack"><label for="plesk_power_pack">plesk_power_pack</label><br/>
                    <input type="checkbox" id="cpanel"><label for="cpanel">cpanel</label><br/>
                    <input type="checkbox" id="kvm"><label for="kvm">kvm</label><br/>
                    <input type="checkbox" id="install_via_lara"><label for="install_via_lara">install_via_lara</label><br/>
                    <input type="checkbox" id="raid4"><label for="raid4">raid4</label><br/>
                    <input type="checkbox" id="bbu"><label for="bbu">bbu</label><br/>
                    <input type="checkbox" id="kvm_module"><label for="kvm_module">kvm_module</label>
                </fieldset>
            </div>
        </div>
        <div class="large-4 column">
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="sas600" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="sas600">sas600</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ssd240" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ssd240">ssd240</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ssd240de" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ssd240de">ssd240de</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ssd480de" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ssd480de">ssd480de</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ssd300" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ssd300">ssd300</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ssd600" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ssd600">ssd600</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="sata2000e" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="sata2000e">sata2000e</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="sata3000e" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="sata3000e">sata3000e</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="sata4000e" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="sata4000e">sata4000e</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="usb16" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="usb16">usb16</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="usb64" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="usb64">usb64</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ramecc32gb" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ramecc32gb">ramecc32gb</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-2 columns">
                    <select id="select_backups">
                        <option>no</option>
                        <option>100</option>
                        <option>500</option>
                        <option>2000</option>
                        <option>5000</option>
                        <option>10000</option>
                    </select>
                </div>
                <div class="small-10 columns">
                    <label class="postfix">Backup Space</label>
                </div>
            </div>
        </div>
        <div class="large-4 column">
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="ip" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="ip">ip</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="subnet29" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="subnet29" data-addtext="6 IPs">subnet29</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="subnet28" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="subnet28" data-addtext="14 IPs">subnet28</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="subnet27" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="subnet27" data-addtext="30 IPs">subnet27</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="failover_ip" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="failover_ip">failover_ip</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="failover_subnet29" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="failover_subnet29" data-addtext="6 IPs">failover_subnet29</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="failover_subnet28" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="failover_subnet28" data-addtext="14 IPs">failover_subnet28</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="failover_subnet27" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="failover_subnet27" data-addtext="30 IPs">failover_subnet27</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="gbit_nic" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="gbit_nic">gbit_nic</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="switch_5port" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="switch_5port">switch_5port</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="switch_8port" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="switch_8port">switch_8port</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="switch_24port" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="switch_24port">switch_24port</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="place_reservation" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="place_reservation">place_reservation</label>
                </div>
            </div>
            <div class="row collapse">
                <div class="small-1 columns">
                    <input type="text" placeholder="0" id="traffic_overusage" />
                </div>
                <div class="small-11 columns">
                    <label class="postfix" for="traffic_overusage">traffic_overusage</label>
                </div>
            </div>
        </div>
        <div class="large-12 column">
            <textarea id="output" readonly>calculation output</textarea>
        </div>
    </form>

    <script>
'use strict';

var messages = {
    setup_fee: {
        English: 'Setup costs:',
        Deutsch: 'Einmalige Kosten:',
        Русский: 'Плата за установку:'
    },
    total_setup: {
        English: 'Total setup costs:',
        Deutsch: 'Gesamte einmalige Kosten:',
        Русский: 'Итого плата за установку:'
    },
    total_monthly: {
        English: 'Total monthly costs:',
        Deutsch: 'Gesamte monatliche Kosten:',
        Русский: 'Итого ежемесячная плата:'
    },
    total_additional: {
        English: 'Total additional costs:',
        Deutsch: 'Gesamte zusätzliche Kosten:',
        Русский: 'Итого дополнительная плата:'
    },
    monthly: {
        English: 'Monthly costs:',
        Deutsch: 'Monatliche Kosten:',
        Русский: 'Ежемесячная плата:'},
    flexi_pack: {
        English: 'Flexi-Pack',
        Deutsch: 'Flexi-Pack',
        Русский: 'Flexi-пакет'
    },
    vat_is_included: {
        English: 'All prices include VAT (19%)',
        Deutsch: 'Alle Preise sind inklusive 19% Mehrwertsteuer',
        Русский: 'Все цены указаны с VAT (19%)'
    },
    vat_isnt_included: {
        English: 'All prices exclude VAT',
        Deutsch: 'Alle Preise sind exklusive Mehrwertsteuer',
        Русский: 'Все цены указаны без VAT'
    },
    first_invoice_addition: {
        English: 'Additional payment for product(s) charged for entire month:',
        Deutsch: 'Zusätzliche kosten fuer Produkt(e) die fuer den gesamente Monat berechnet werden:',
        Русский: 'В первый счёт будет дополнительно включена плата за продукт(ы) лицензируемые помесячно:'
    },
    comment: {
        English: 'Comment:',
        Deutsch: 'Kommentar:',
        Русский: 'Комментарий:'
    },
    first_invoice_amount: {
        English: 'First invoice`s amount:',
        Deutsch: 'First invoice`s amount:',
        Русский: 'Сумма первого счёта:'
    },
    subsequent_amount: {
        English: 'Subsequent invoices amount:',
        Deutsch: 'Subsequent invoices amount:',
        Русский: 'Сумма в последующих счетах:'
    },
    /*
    template: {
        English: '',
        Deutsch: '',
        Русский: ''
    },
    */
};

var servers = {
    SB: {
        monthly: 0, setup: 0,
        name: {
            English: 'Server SB',
            Deutsch: 'Server SB',
            Русский: 'Сервер SB'
        },
        comment: 'SB servers: no additional hardware'
    },
    EX40: {
        monthly: 49, setup: 0,
        name: {
            English: 'Server EX40',
            Deutsch: 'Server EX40',
            Русский: 'Сервер EX40'
        },
        comment: 'EX servers: setup fee=0 in July 2014\nEX40: 20 TB included'
    },
    EX40SSD: {
        monthly: 59, setup: 0,
        name: {
            English: 'Server EX40-SSD',
            Deutsch: 'Server EX40-SSD',
            Русский: 'Сервер EX40-SSD'
        },
        comment: 'EX servers: setup fee=0 in July 2014\nEX40-SSD: 20 TB included'
    },
    EX60: {
        monthly: 59, setup: 0,
        name: {
            English: 'Server EX60',
            Deutsch: 'Server EX60',
            Русский: 'Сервер EX60'
        },
        comment: 'EX60: 20 TB included'
    },
    PX60: {
        monthly: 69, setup: 0,
        name: {
            English: 'Server PX60',
            Deutsch: 'Server PX60',
            Русский: 'Сервер PX60'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX60: 20 TB included'
    },
    PX60SSD: {
        monthly: 79, setup: 0,
        name: {
            English: 'Server PX60-SSD',
            Deutsch: 'Server PX60-SSD',
            Русский: 'Сервер PX60-SSD'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX60-SSD: 20 TB included'
    },
    PX70: {
        monthly: 79, setup: 0,
            name: {
            English: 'Server PX70',
            Deutsch: 'Server PX70',
            Русский: 'Сервер PX70'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX70: 20 TB included'
    },
    PX70SSD: {
        monthly: 99, setup: 0,
        name: {
            English: 'Server PX70-SSD',
            Deutsch: 'Server PX70-SSD',
            Русский: 'Сервер PX70-SSD'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX70-SSD: 30 TB included'
    },
    PX90: {
        monthly: 99, setup: 0,
        name: {
            English: 'Server PX90',
            Deutsch: 'Server PX90',
            Русский: 'Сервер PX90'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX90: 30 TB included'
    },
    PX90SSD: {
        monthly: 109, setup: 0,
        name: {
            English: 'Server PX90-SSD',
            Deutsch: 'Server PX90-SSD',
            Русский: 'Сервер PX90-SSD'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX90-SSD: 30 TB included'
    },
    PX120: {
        monthly: 129, setup: 0,
            name: {
            English: 'Server PX120',
            Deutsch: 'Server PX120',
            Русский: 'Сервер PX120'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX120: 30 TB included'
    },
    PX120SSD: {
    monthly: 139, setup: 0,
        name: {
            English: 'Server PX120-SSD',
            Deutsch: 'Server PX120-SSD',
            Русский: 'Сервер PX120-SSD'
        },
        comment: 'PX servers: setup fee=0 in July 2014\nPX120-SSD: 30 TB included'
    },
    SX60: {
        monthly: 69, setup: 69,
        name: {
            English: 'Server SX60',
            Deutsch: 'Server SX60',
            Русский: 'Сервер SX60'
        },
        comment: 'SX60: 20 TB included\nSX60: HW-RAID addon is available'
    },
    SX130: {
        monthly: 139, setup: 139,
        name: {
            English: 'Server SX130',
            Deutsch: 'Server SX130',
            Русский: 'Сервер SX130'
        },
        comment: 'SX130: 30 TB included'
    },
    SX290: {
        monthly: 299, setup: 299,
        name: {
            English: 'Server SX290',
            Deutsch: 'Server SX290',
            Русский: 'Сервер SX290'
        },
        comment: 'SX290: 50 TB included\nSX290: additional single IP is not possible'
    },
    DX150: {
        monthly: 159, setup: 199,
        flexi_included: true,
        name: {
            English: 'DELL PowerEdge™ R720 DX150',
            Deutsch: 'DELL PowerEdge™ R720 DX150',
            Русский: 'DELL PowerEdge™ R720 DX150'
        },
        comment: "DX150: 30 TB included\n\
R720: have an iDRAC (IP-KVM)\n\
R720: Drives are optional (3TB Enterprise HDD, 600GB SAS and 300/600GB SSD)\n\
R720: Flexi-Pack is included\n\
R720 DX150: max 192 GB RAM (4x 32GB)"
    },
    DX290: {
        monthly: 299, setup: 199,
        flexi_included: true,
        name: {
            English: 'DELL PowerEdge™ R720 DX290',
            Deutsch: 'DELL PowerEdge™ R720 DX290',
            Русский: 'DELL PowerEdge™ R720 DX290'
        },
        comment: "DX290: 50 TB included\n\
R720: have an iDRAC (IP-KVM)\n\
R720: Drives are optional (3TB Enterprise HDD, 600GB SAS and 300/600GB SSD)\n\
R720: Flexi-Pack is included\n\
R720 DX290: max 384 GB RAM (8x 32GB)"
    },
    RACK20: {
        monthly: 199, setup: 0,
        name: {
            English: 'Dedicated Rack for up to 20 dedicated servers',
            Deutsch: 'Miet-Rack für bis zu 20 Root-Server',
            Русский: 'Выделенная стойка для 20 root-серверов'
        },
        comment: "RACK20: 24 port Gbit switch included\n\
RACK20: customer need at least 7 servers to order this rack\n\
RACK20: http://wiki.hetzner.de/index.php/Spezielle_Angebote/en#Dedicated_Rack_for_up_to_20_dedicated_servers"
    },
    VQ7: {
        monthly: 7.90, setup: 0,
        name: {
            English: 'Server VQ7',
            Deutsch: 'Server VQ7',
            Русский: 'Сервер VQ7'
        },
        comment: 'VQ7: 1 TB included'
    },
    VQ12: {
        monthly: 12.90, setup: 0,
        name: {
            English: 'Server VQ12',
            Deutsch: 'Server VQ12',
            Русский: 'Сервер VQ12'
        },
        comment: 'VQ7: 2 TB included'
    },
    VQ19: {
        monthly: 19.90, setup: 0,
        name: {
            English: 'Server VQ19',
            Deutsch: 'Server VQ19',
            Русский: 'Сервер VQ19'
        },
        comment: 'VQ7: 4 TB included'
    }
    /*
    template: {
        monthly: 0, setup: 0,
        flexi_included: true,
        name: {
            English: '',
            Deutsch: '',
            Русский: ''
        },
        comment: 'line1\nline2',
    },
    */
};

var addons = {
    kvm: {
        monthly: 19, setup: 149, flexi_required: true,
        name: {
            English: 'KVM-over-IP Remote Management',
            Deutsch: 'KVM-over-IP Remote Management',
            Русский: 'KVM-over-IP удалённое управление'
        }
    },
    usb16: {
        setup: 39,
        name: {
            English: '16 GB USB stick',
            Deutsch: '16 GB USB-Stick',
            Русский: '16 ГБ USB-накопитель'
        }
    },
    usb64: {
        setup: 139,
        name: {
            English: '64 GB USB stick',
            Deutsch: '64 GB USB-Stick',
            Русский: '64 ГБ USB-накопитель'
        }
    },
    ramecc32gb: {
        monthly: 29,
        name: {
            English: '32 GB DDR3 ECC RAM',
            Deutsch: '32 GB DDR3 ECC RAM',
            Русский: '32 ГБ DDR3 оперативной памяти ECC'
        },
        comment: "32 GB DDR3 ECC RAM: is available only for DELL R720\n\
32 GB DDR3 ECC RAM: maximum 8"
    },
    win_std: {
        monthly: 25, pay_entire_month: true,
        name: {
            English: 'Windows Server 2012 R2 Standard Edition',
            Deutsch: 'Windows Server 2012 R2 Standard Edition',
            Русский: 'Windows Server 2012 R2 Standard Edition'
        }
    },
    win_dc: {
        monthly: 137, pay_entire_month: true,
        name: {
            English: 'Windows Server 2012 R2 Datacenter Edition',
            Deutsch: 'Windows Server 2012 R2 Datacenter Edition',
            Русский: 'Windows Server 2012 R2 Datacenter Edition'
        }
    },
    plesk_web_admin: {
        monthly: 2.49, pay_entire_month: "yes",
        name: {
            English: "Plesk 12 Web ADMIN Edition",
            Deutsch: "Plesk 12 Web ADMIN Edition",
            Русский: "Plesk 12 издание Web ADMIN"},
    },
     plesk_web_app: {
        monthly: 3.49, pay_entire_month: "yes",
        name: {
            English: "Plesk 12 Web APP Edition",
            Deutsch: "Plesk 12 Web APP Edition",
            Русский: "Plesk 12 издание Web APP"},
    },
     plesk_web_pro: {
        monthly: 5.49, pay_entire_month: "yes",
        name: {
            English: "Plesk 12 Web PRO Edition",
            Deutsch: "Plesk 12 Web PRO Edition",
            Русский: "Plesk 12 издание Web PRO"},
    },
     plesk_web_host: {
        monthly: 29.99, pay_entire_month: "yes",
        name: {
            English: "Plesk 12 Web HOST Edition",
            Deutsch: "Plesk 12 Web HOST Edition",
            Русский: "Plesk 12 издание Web HOST"},
    },
    plesk_power_pack: {
        monthly: 9.9, pay_entire_month: true,
        name: {
            English: 'Plesk Power Pack',
            Deutsch: 'Plesk Power Pack',
            Русский: 'Plesk Power Pack'
        }
    },
    cpanel: {
        monthly: 29.9, pay_entire_month: true,
        name: {
            English: 'cPanel',
            Deutsch: 'cPanel',
            Русский: 'cPanel'
        }
    },
    raid4: {
        monthly: 15, flexi_required: true,
        name: {
            English: '4-Port Hardware RAID controller',
            Deutsch: '4-Port Hardware RAID-Controller',
            Русский: '4-портовый RAID-контроллер'
        }
    },
    ip: {
        monthly: 1,
        name: {
            English: 'Additional IP address',
            Deutsch: 'Zusätzliche IP-Adresse',
            Русский: 'Дополнительный IP-адрес'
        }
    },
    subnet29: {
        monthly: 8, flexi_required: true,
        name: {
            English: 'Subnet /29',
            Deutsch: 'Subnet /29',
            Русский: 'Подсеть /29'
        }
    },
    subnet28: {
        monthly: 16, flexi_required: true,
        name: {
            English: 'Subnet /28',
            Deutsch: 'Subnet /28',
            Русский: 'Подсеть /28'
        }
    },
    subnet27: {
        monthly: 32, flexi_required: true,
        name: {
            English: 'Subnet /27',
            Deutsch: 'Subnet /27',
            Русский: 'Подсеть /27'
        }
    },
    failover_ip: {
        monthly: 5, flexi_required: true,
        name: {
            English: 'Failover IP',
            Deutsch: 'Failover-IP',
            Русский: 'Failover IP'
        },
        comment: 'Failover IP: can`t be used with VMware ESXi'
    },
    failover_subnet29: {
        monthly: 18, flexi_required: true,
        name: {
            English: 'Failover subnet /29',
            Deutsch: 'Failover Subnet /29',
            Русский: 'Failover подсеть /29'
        },
        comment: 'Failover subnet /29: can`t be used with VMware ESXi'
    },
    failover_subnet28: {
        monthly: 26, flexi_required: true,
        name: {
            English: 'Failover subnet /28',
            Deutsch: 'Failover Subnet /28',
            Русский: 'Failover подсеть /28'
        },
        comment: 'Failover subnet /28: can`t be used with VMware ESXi'
    },
    failover_subnet27: {
        monthly: 42, flexi_required: true,
        name: {
            English: 'Failover subnet /27',
            Deutsch: 'Failover Subnet /27',
            Русский: 'Failover подсеть /27'
        },
        comment: 'Failover subnet /27: can`t be used with VMware ESXi'
    },
    ssd240: {
        monthly: 19, flexi_required: true,
        name: {
            English: '240 GB SSD',
            Deutsch: '240 GB SSD',
            Русский: '240 ГБ SSD'
        }
    },
    ssd240de: {
        monthly: 25, flexi_required: true,
        name: {
            English: '240 GB 6 Gb/s SSD Datacenter Edition',
            Deutsch: '240 GB 6 Gb/s SSD Datacenter Edition',
            Русский: '240 ГБ 6 Гбит/с SSD Datacenter Edition'
        }
    },
    ssd480de: {
        monthly: 39, flexi_required: true,
        name: {
            English: '480 GB 6 Gb/s SSD Datacenter Edition',
            Deutsch: '480 GB 6 Gb/s SSD Datacenter Edition',
            Русский: '480 ГБ 6 Гбит/с SSD Datacenter Edition'
        }
    },
    ssd300: {
        monthly: 29, flexi_required: true,
        name: {
            English: '300 GB SSD',
            Deutsch: '300 GB SSD',
            Русский: '300 ГБ SSD'
        },
        comment: '300 GB SSD: is available only for DELL R720'
    },
    ssd600: {
        monthly: 50, flexi_required: true,
        name: {
            English: '600 GB SSD',
            Deutsch: '600 GB SSD',
            Русский: '600 ГБ SSD'
        },
        comment: '600 GB SSD: is available only for DELL R720'
    },
    sas600: {
        monthly: 25, flexi_required: true,
        name: {
            English: '600 GB SAS',
            Deutsch: '600 GB SAS',
            Русский: '600 ГБ SAS'
        },
        comment: '600 GB SAS: is available only for DELL R720'
    },
    sata2000e: {
        monthly: 15, flexi_required: true,
        name: {
            English: '2 TB enterprise SATA HDD',
            Deutsch: '2 TB Enterprise SATA HDD',
            Русский: '2 ТБ enterprise SATA HDD'
        },
    },
    sata3000e: {
        monthly: 25, flexi_required: true,
        name: {
            English: '3 TB enterprise SATA HDD',
            Deutsch: '3 TB Enterprise SATA HDD',
            Русский: '3 ТБ enterprise SATA HDD'
        }
    },
    sata4000e: {
        monthly: 30, flexi_required: true,
        name: {
            English: '4 TB enterprise SATA HDD',
            Deutsch: '4 TB Enterprise SATA HDD',
            Русский: '4 ТБ enterprise SATA HDD'
        }
    },
    gbit_nic: {
        setup: 29, flexi_required: true,
        name: {
            English: 'Additional Gbit NIC',
            Deutsch: 'Zusätzliche Gbit-NIC',
            Русский: 'Дополнительная 1Гбит сетевая карта'
        }
    },
    install_via_lara: {
        setup: 25,
        name: {
            English: 'Installation via LARA',
            Deutsch: 'Installation via LARA',
            Русский: 'Установка ОС через LARA'
        }
    },
    switch_5port: {
        setup: 29, flexi_required: true,
        name: {
            English: '5-Port Gbit switch',
            Deutsch: '5-Port Gbit-Switch',
            Русский: 'Коммутатор Гбит 5 портов'
        }
    },
    switch_8port: {
        setup: 39, flexi_required: true,
        name: {
            English: '8-Port Gbit switch',
            Deutsch: '8-Port Gbit-Switch',
            Русский: 'Коммутатор Гбит 8 портов'
        }
    },
    switch_24port: {
        setup: 269, flexi_required: true,
        name: {
            English: '24-Port Gbit switch',
            Deutsch: '24-Port Gbit-Switch',
            Русский: 'Коммутатор Гбит 24 порта'
        }
    },
    rdp_license: {
        monthly: 7,
        name: {
            English: 'Additional RDP licence for Windows',
            Deutsch: 'Zusätzliche RDP-Lizenz für Windows',
            Русский: 'Дополнительная RDP-лицензия для Windows'
        }
    },
    place_reservation: {
        monthly: 9.90,
        name: {
            English: 'Reservation of rack space',
            Deutsch: 'Platz Reservierung: Mietserver Stellfläche',
            Русский: 'Резервирование места в стойке'
        },
        comment: 'Reservation of rack space: no more then 50% of number of servers'
    },
    bbu: {
        setup: 149,
        name: {
            English: 'BBU for RAID controller',
            Deutsch: 'BBU für RAID-Controller',
            Русский: 'BBU для RAID-контроллера'
        }
    },
    traffic_overusage: {
        monthly: 1.99,
        name: {
            English: 'Traffic overusage (TB)',
            Deutsch: 'Traffic overusage (TB)',
            Русский: 'Превышение трафика (ТБ)'
        }
    },
    kvm_module: {
        monthly: 3.90, setup: 19,
        name: {
            English: 'KVM-module',
            Deutsch: 'KVM-modul',
            Русский: 'KVM-модуль'
        },
        comment: 'KVM-module: only for PX60(-SSD) and PX70(-SSD)'
    },
    backup100: {
        monthly: 4.90, setup: 4.90,
        name: {
            English: '100 GB Backup Space',
            Deutsch: '100 GB Backup Space',
            Русский: '100 ГБ места для резервных копий'
        }
    },
    backup500: {
        monthly: 9.90, setup: 9.90,
        name: {
            English: '500 GB Backup Space',
            Deutsch: '500 GB Backup Space',
            Русский: '500 ГБ места для резервных копий'
        }
    },
    backup2000: {
        monthly: 19.90, setup: 19.90,
        name: {
            English: '2,000 GB Backup Space',
            Deutsch: '2.000 GB Backup Space',
            Русский: '2.000 ГБ места для резервных копий'
        }
    },
    backup5000: {
        monthly: 44.90, setup: 44.90,
        name: {
            English: '5,000 GB Backup Space',
            Deutsch: '5.000 GB Backup Space',
            Русский: '5.000 ГБ места для резервных копий'
        }
    },
    backup10000: {
        monthly: 79.90, setup: 79.90,
        name: {
            English: '10,000 GB Backup Space',
            Deutsch: '10.000 GB Backup Space',
            Русский: '10.000 ГБ места для резервных копий'
        }
    }
    /*
    template: {
        monthly: 0, setup: 0, flexi_required: true, pay_entire_month: true,
        name: {
            English: '',
            Deutsch: '',
            Русский: ''
        },
        comment: 'line1\nline2',
    },
    */
};

var uiLanguage = 'English';

/**
 * Init application.
 */
function onLoad() {
    setAndUpdateUILanguage();
    updateDate();
    updateCalculationResult();
}

/**
 * Updates Date input field to todays date.
 */
function updateDate() {
    var today = new Date();
    document.getElementById('ordering_date').value =
        today.getFullYear() + '/' +
        (today.getMonth() + 1) + '/' +
        today.getDate();
}

/**
 * Called each time we change something in the form.
 */
function onChange() {
    updateCalculationResult();
}

/**
 * Updates interfce language.
 */
function setAndUpdateUILanguage() {
    uiLanguage = document.getElementById('select_languages').value;
    for (var addon in addons) {
        var labelElement = document.querySelector("label[for='" + addon + "']");
        if (labelElement) {
            var additionalText = labelElement.getAttribute('data-addtext');
            var labelValueToSet = addons[addon].name[uiLanguage];
            labelElement.innerHTML = (additionalText) ? labelValueToSet + ' ' + '<mark>' + additionalText + '</mark>' : labelValueToSet;
        }
    }
}

/**
 * Updates textarea containing caluculation result.
 */
function updateCalculationResult() {
    var selectedServerModel = document.getElementById('select_servers').value;
    var serverToCalculate = new Server(selectedServerModel);

    var calculationTextBeautified = serverToCalculate.getCalculationStringBeautified();
    document.getElementById('output').innerHTML = '';
    document.getElementById('output').innerHTML += calculationTextBeautified;

    var numberOfLinesInCalculationText = calculationTextBeautified.split(/\n|\r|\n\r/).length + 1;
    document.getElementById('output').rows = numberOfLinesInCalculationText;
}

function Server(theModel) {
    this.FLEXI_PACK_PRICE = 15;
    this.VAT_PERCENTAGE = 19;
    this.model = servers[theModel];
    if (theModel === 'SB') {
        var sbServerMonthlyPrice = parseInt(document.getElementById('sb_number').value);
        if (sbServerMonthlyPrice > 0) {
            this.model.monthly = sbServerMonthlyPrice;
        } else {
            this.model.monthly = 0;
        }
    }
    this.serverAddons = [];
    this.flexiRequiredForAddons = false;
    this.isVatChecked = (document.getElementById('vat_included').checked);
    this.findAndAddAddons();
}

function copyObject(object) {
    var newObject = {};
    for (var key in object) {
        newObject[key] = object[key];
    }
    return newObject;
}

Server.prototype = {
    constructor: Server,
    addAddon: function(addon, amount) {
        var addonObj = copyObject(addons[addon]);
        if (addon === 'backup100' && this.model.monthly >= 49) {
            addonObj.monthly = 0;
            addonObj.setup = 0;
        }
        if (amount !== undefined) addonObj.amount = amount;
        this.serverAddons.push( addonObj );
    },
    isFlexiToCalculate: function() {
        if (this.model.flexi_included) return false;
        if (this.flexiRequiredForAddons) return true;
    },
    findAndAddAddons: function () {
        for (var addon in addons) {
            if (document.getElementById(addon)) {
                if (document.getElementById(addon).type === 'checkbox') {
                    if (document.getElementById(addon).checked) {
                        this.addAddon(addon);
                    }
                }
                if (document.getElementById(addon).type === 'text') {
                    var amount = parseInt(document.getElementById(addon).value);
                    if (amount) {
                        this.addAddon(addon, amount);
                    }
                }
            }
        }
        if (document.getElementById('select_backups').value !== 'no') {
            var backupAddon = 'backup' + document.getElementById('select_backups').value;
            this.addAddon(backupAddon);
        }
        if (document.getElementById('select_plesk').value !== 'no') {
            var backupAddon = 'plesk_' + document.getElementById('select_plesk').value;
            this.addAddon(backupAddon);
        }
    },
    getSetupPrice: function() {
        return ('setup' in this.model) ? this.model.setup : 0;
    },
    getSetupPriceVatted: function() {
        return this.vatPrice( this.getSetupPrice() );
    },
    getMonthlyPrice: function() {
        return ('monthly' in this.model) ? this.model.monthly : 0;
    },
    getMonthlyPriceVatted: function() {
        return this.vatPrice( this.getMonthlyPrice() );
    },
    getName: function() {
        var modelName = this.model.name[uiLanguage];
        if ((modelName.indexOf('SB') !== -1) && (this.model.monthly > 0)) {
            return modelName + this.model.monthly;
        }
        return modelName;
    },
    getSetupPriceTotal: function() {
        var setupPriceTotal = this.getSetupPrice();
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('setup' in addonObj) {
                setupPriceTotal += ('amount' in addonObj && addonObj.amount > 1) ? (addonObj.amount * addonObj.setup) : addonObj.setup;
            }
        }
        return setupPriceTotal;
    },
    getSetupPriceTotalVatted: function() {
        // return this.vatPrice( this.getSetupPriceTotal() );
        var setupPriceTotal = this.getSetupPriceVatted();
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('setup' in addonObj) {
                setupPriceTotal += ('amount' in addonObj && addonObj.amount > 1) ? this.vatPrice(addonObj.amount * addonObj.setup) : this.vatPrice(addonObj.setup);
            }
        }
        return setupPriceTotal;
    },
    getMonthlyPriceTotal: function() {
        var monthlyPriceTotal = this.getMonthlyPrice();
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('monthly' in addonObj) {
                if (!this.flexiRequiredForAddons && 'flexi_required' in addonObj) {
                    this.flexiRequiredForAddons = addonObj.flexi_required;
                }
                monthlyPriceTotal += ('amount' in addonObj && addonObj.amount > 1) ? addonObj.amount * addonObj.monthly : addonObj.monthly;
            }
        }
        monthlyPriceTotal += ( this.isFlexiToCalculate() ) ? this.FLEXI_PACK_PRICE : 0;
        return monthlyPriceTotal;
    },
    getMonthlyPriceTotalVatted: function() {
        // return this.vatPrice( this.getMonthlyPriceTotal() );
        var monthlyPriceTotal = this.getMonthlyPriceVatted();
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('monthly' in addonObj) {
                if (!this.flexiRequiredForAddons && 'flexi_required' in addonObj) {
                    this.flexiRequiredForAddons = addonObj.flexi_required;
                }
                monthlyPriceTotal += ('amount' in addonObj && addonObj.amount > 1) ? this.vatPrice(addonObj.amount * addonObj.monthly) : this.vatPrice(addonObj.monthly);
            }
        }
        monthlyPriceTotal += ( this.isFlexiToCalculate() ) ? this.vatPrice(this.FLEXI_PACK_PRICE) : 0;
        return monthlyPriceTotal;
    },
    getAddonAdditionalPaymentVatted: function(price) {
        var orderingDate = new Date(document.getElementById('ordering_date').value);
        var daysInMonth = new Date(orderingDate.getFullYear(), orderingDate.getMonth() + 1, 0).getDate();
        var orderingDay = orderingDate.getDate();

        return this.vatPrice(price / daysInMonth * (orderingDay - 1));
    },
    getAdditionalPaymentTotalVatted: function() {
        var additionalPaymentTotal = 0;
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if (addonObj.pay_entire_month) {
                additionalPaymentTotal += this.getAddonAdditionalPaymentVatted(addonObj.monthly);
            }
        }
        return additionalPaymentTotal;
    },
    formatSetupPriceString: function() {
        var str = '\n' + this.getName() + ' ' + this.getSetupPriceVatted() + ' €';
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('setup' in addonObj) {
                if ('amount' in addonObj && addonObj.amount > 1) {
                    str += '\n' + addonObj.amount + 'x ' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.amount * addonObj.setup) + ' €';
                } else {
                    str += '\n' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.setup) + ' €';
                }
            }
        }
        return str;
    },
    formatMonthlyPriceString: function() {
        var str = '\n' + this.getName() + ' ' + this.getMonthlyPriceVatted() + ' €';
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('monthly' in addonObj) {
                if ('amount' in addonObj && addonObj.amount > 1) {
                    str += '\n' + addonObj.amount + 'x ' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.amount * addonObj.monthly).toFixed(2) + ' €';
                } else {
                    str += '\n' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.monthly) + ' €';
                }
            }
        }
        if ( this.isFlexiToCalculate() ) {
            str += '\n' + messages.flexi_pack[uiLanguage] + ' ' + this.vatPrice(this.FLEXI_PACK_PRICE) + ' €';
        }
        return str;
    },
    formatCommentString: function() {
        var str = '\n' + 'COMMENTS:';
        if ('comment' in this.model) {
            str += '\n' + this.model.comment;
        }
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('comment' in addonObj) {
                str += '\n' + addonObj.comment;
            }
        }
        return str;
    },
    formatAdditionalPaymentString: function() {
        var hasPayEntireMonthAddons = false;
        var str = '\n' + messages.first_invoice_addition[uiLanguage];
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if (addonObj.pay_entire_month) {
                hasPayEntireMonthAddons = true;
                str += '\n' + addonObj.name[uiLanguage] + ' ' + this.getAddonAdditionalPaymentVatted(addonObj.monthly) + ' €';
            }
        }
        str += '\n' + 'Total additional payment: ' + this.getAdditionalPaymentTotalVatted() + ' €';
        return (hasPayEntireMonthAddons) ? str : '';
    },
    getMonthlyInvoiceAmountVatted: function() {
        return this.getMonthlyPriceTotalVatted();
    },
    getFirstInvoiceAmountVatted: function() {
        return this.getMonthlyPriceTotalVatted() + this.getAdditionalPaymentTotalVatted() + this.getSetupPriceTotalVatted();
    },
    formatMonthlyPriceStringNew: function() {
        if (this.getMonthlyPriceTotalVatted() === 0)
            return '';

        var str = messages.monthly[uiLanguage] +
            '\n' + this.getName() + ' ' + this.getMonthlyPriceVatted().toFixed(2) + ' €';
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('monthly' in addonObj) {
                if ('amount' in addonObj && addonObj.amount > 1) {
                    str += '\n' + addonObj.amount + 'x ' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.amount * addonObj.monthly).toFixed(2) + ' €';
                } else {
                    str += '\n' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.monthly).toFixed(2) + ' €';
                }
            }
        }
        if ( this.isFlexiToCalculate() ) {
            str += '\n' + messages.flexi_pack[uiLanguage] + ' ' + this.vatPrice(this.FLEXI_PACK_PRICE).toFixed(2) + ' €';
        }
        str += '\n-';
        str += '\n' + messages.total_monthly[uiLanguage] + ' ' + this.getMonthlyPriceTotalVatted().toFixed(2) + ' €';
        return str;
    },
    formatSetupPriceStringNew: function() {
        if (this.getSetupPriceTotalVatted() === 0)
            return '';

        var str = messages.setup_fee[uiLanguage] +
            '\n' + this.getName() + ' ' + this.getSetupPriceVatted().toFixed(2) + ' €';
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('setup' in addonObj) {
                if ('amount' in addonObj && addonObj.amount > 1) {
                    str += '\n' + addonObj.amount + 'x ' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.amount * addonObj.setup).toFixed(2) + ' €';
                } else {
                    str += '\n' + addonObj.name[uiLanguage] + ' ' + this.vatPrice(addonObj.setup).toFixed(2) + ' €';
                }
            }
        }
        str += '\n-';
        str += '\n' + messages.total_setup[uiLanguage] + ' ' + this.getSetupPriceTotalVatted().toFixed(2) + ' €';
        return str;
    },
    formatAdditionalPaymentStringNew: function() {
        var hasPayEntireMonthAddons = false;
        var str = messages.first_invoice_addition[uiLanguage];
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if (addonObj.pay_entire_month) {
                hasPayEntireMonthAddons = true;
                str += '\n' + addonObj.name[uiLanguage] + ' ' + this.getAddonAdditionalPaymentVatted(addonObj.monthly).toFixed(2) + ' €';
            }
        }
        str += '\n-';
        str += '\n' + messages.total_additional[uiLanguage] + ' ' + this.getAdditionalPaymentTotalVatted().toFixed(2) + ' €';
        return (hasPayEntireMonthAddons) ? str : '';
    },
    formatFirstInvoiceString: function() {
        var str = '';
        if (this.getSetupPriceTotalVatted() !== 0 || this.getAdditionalPaymentTotalVatted() !== 0) {
            str += messages.first_invoice_amount[uiLanguage] + ' '  + this.getFirstInvoiceAmountVatted().toFixed(2) + ' €' + '.';
            str += '\n' + messages.subsequent_amount[uiLanguage] + ' ' + this.getMonthlyInvoiceAmountVatted().toFixed(2) + ' €' + '.';
        }
        return str;
    },
    formatCommentStringNew: function() {
        var str = '';
        if (this.isVatChecked) {
            str += messages.vat_is_included[uiLanguage];
        } else {
            str += messages.vat_isnt_included[uiLanguage];
        }
        str += '\n' + '\n' + messages.comment[uiLanguage];
        if ('comment' in this.model) {
            str += '\n' + this.model.comment;
        }
        for (var i = 0; i < this.serverAddons.length; i++) {
            var addonObj = this.serverAddons[i];
            if ('comment' in addonObj) {
                str += '\n' + addonObj.comment;
            }
        }
        return str;
    },
    getCalculationString: function() {
        return  ((this.formatMonthlyPriceStringNew()      === '' || !this.getMonthlyPriceTotalVatted())      ? '' : this.formatMonthlyPriceStringNew()      + '\n\n' ) +
                ((this.formatSetupPriceStringNew()        === '' || !this.getSetupPriceTotalVatted())        ? '' : this.formatSetupPriceStringNew()        + '\n\n' ) +
                ((this.formatAdditionalPaymentStringNew() === '' || !this.getAdditionalPaymentTotalVatted()) ? '' : this.formatAdditionalPaymentStringNew() + '\n\n' ) +
                ((this.formatFirstInvoiceString()         === '' ) ? '' : this.formatFirstInvoiceString() + '\n\n' ) +
                this.formatCommentStringNew();
    },
    getCalculationStringBeautified: function() {
        var INDENT = '    ';
        var output = '';
        var maxTextLength = 0;
        var maxPriceLength = 0;
        var expr = /^(.*) ([0-9\.]+ €)$/;

        var lines = this.getCalculationString().split('\n');
        var line = '';
        var temp = '';

        for(var n = 0; n < lines.length; n++) {
            line = lines[n];

            temp = line.match(expr);

            if (temp !== null) {
                var textLen = temp[1].length + 1;
                var priceLen = temp[2].length;
                if (textLen > maxTextLength) {
                    maxTextLength = textLen;
                }

                if (priceLen > maxPriceLength) {
                    maxPriceLength = priceLen;
                }
            }
        }

        for(var i = 0; i < lines.length; i++) {
            line = lines[i];

            temp = line.match(expr);

            if (line === '-') {
                output += INDENT;
                for (var j = 0; j < maxTextLength + maxPriceLength; j++) {
                    output += '-';
                }
                output += '\n';

            } else if (temp === null) {

                output += line + '\n';

            } else {
                var text  = temp[1];
                var price = temp[2];

                output += INDENT + text;
                for (var k = 0; k < maxTextLength - text.length + maxPriceLength - price.length; k++) {
                    output += ' ';
                }
                output += price + '\n';

            }
        }
        return output;
    },
    /**
     * Checks if VAT is checked and returns price with or without VAT.
     *
     * @param {Number} price Price to process.
     * @returns {Number} Price or price without VAT.
     */
    vatPrice: function(price) {
        return (this.isVatChecked) ? this.round(price, 2) : this.round(price / (100 + this.VAT_PERCENTAGE) * 100, 2);
    },
    /**
     * Returns rounded value to a decimal place.
     *
     * Using just a Math.round() is a common solution but sometimes a decimal of 5
     * is rounded down instead of up:
     * Math.round(1.005*100)/100; // 1 instead of 1.01
     *
     * Better solution is using numbers represented in exponential notation.
     *
     * @param {Number} value Value to round.
     * @param {Number} decimals Number of decimal places.
     * @returns {Number} Rounded value.
     */
    round: function(value, decimals) {
        return Number(Math.round(value+'e'+decimals)+'e-'+decimals);
    }
};

</script>

</body>
</html>
